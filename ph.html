<!DOCTYPE html>
<html lang="zh">

<!--  by 白篮 -->
<!--  想抄就拿走，拿走我会很高兴 -->

<head>
    <title>易块编辑器</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="eblock,eblock编辑器,etupcode,eblock-cn,etup,白篮">
    <meta name="description" content="eblock编辑器：基于google-blockly二次开发的轻量化积木编程软件 支持python/js">
    <meta name="author" content="白篮,doutianyang@163.com">
    <meta name="copyright" content="白篮 版权所有">
    <script src="core.js"></script>
    <script src="block.js"></script>
    <script src="javascript_compressed.js"></script>
    <script src="python_compressed.js"></script>
    <script src="zh-hans.js"></script>
    <script src="lan-block.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@1.0.0/dist/css/mdui.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/mdui@1.0.0/dist/js/mdui.min.js"></script>
</head>

<body>
    <div class="mdui-appbar">
        <div class="mdui-tab mdui-color-grey-800" mdui-tab>
            <a href="javascript:;" class="mdui-typo-title">易块编辑器 测试版</a>
        </div>
    </div>
    <small>&nbsp;</small>
    <div class="div">
        <button class="mdui-btn mdui-ripple mdui-color-grey-200" onclick="showjs()">生成js</button>
        <button class="mdui-btn mdui-ripple mdui-color-grey-200" onclick="showpy()">生成py</button>
        <button class="mdui-btn mdui-btn-icon" onclick="runCode()" id="play"><i class="mdui-icon material-icons">play_arrow</i></button>
    </div>
    <p4>&nbsp;</p4>
    <div id="blocklyDiv" style="height: 500px; width: 700px;">
        <!-- 定义编辑器主题大小 -->
        <xml id="toolbox" style="display: none">
            <category name="逻辑" colour="%{BKY_LOGIC_HUE}">
                <!-- 一堆代码盒 -->
                <block type="controls_if">
                </block>
                <block type="controls_if">
                    <mutation else="1"></mutation>
                </block>
                <block type="controls_if">
                    <mutation elseif="1" else="1"></mutation>
                </block>
            </category>
            <category name="布尔逻辑" colour="%{BKY_LOGIC_HUE}">
                <block type="logic_compare">
                </block>
                <block type="logic_operation">
                </block>
                <block type="logic_negate">
                </block>
                <block type="logic_boolean">
                </block>
                <block type="logic_null">
                </block>
                <block type="logic_ternary">
                </block>
            </category>
            <category name="循环" colour="%{BKY_LOOPS_HUE}">
                <block type="controls_repeat_ext">
                    <value name="TIMES">
                        <shadow type="math_number">
                            <field name="NUM">
                                10
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="controls_whileUntil">
                </block>
                <block type="controls_for">
                    <value name="FROM">
                        <shadow type="math_number">
                            <field name="NUM">
                                1
                            </field>
                        </shadow>
                    </value>
                    <value name="TO">
                        <shadow type="math_number">
                            <field name="NUM">
                                10
                            </field>
                        </shadow>
                    </value>
                    <value name="BY">
                        <shadow type="math_number">
                            <field name="NUM">
                                1
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="controls_forEach">
                </block>
                <block type="controls_flow_statements">
                </block>
            </category>
            <category name="计算" colour="%{BKY_MATH_HUE}">
                <block type="math_number">
                    <field name="NUM">
                        123
                    </field>
                </block>
                <block type="math_arithmetic">
                    <value name="A">
                        <shadow type="math_number">
                            <field name="NUM">
                                1
                            </field>
                        </shadow>
                    </value>
                    <value name="B">
                        <shadow type="math_number">
                            <field name="NUM">
                                1
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_single">
                    <value name="NUM">
                        <shadow type="math_number">
                            <field name="NUM">
                                9
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_trig">
                    <value name="NUM">
                        <shadow type="math_number">
                            <field name="NUM">
                                45
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_constant">
                </block>
                <block type="math_number_property">
                    <value name="NUMBER_TO_CHECK">
                        <shadow type="math_number">
                            <field name="NUM">
                                0
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_round">
                    <value name="NUM">
                        <shadow type="math_number">
                            <field name="NUM">
                                3.1
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_on_list">
                </block>
                <block type="math_modulo">
                    <value name="DIVIDEND">
                        <shadow type="math_number">
                            <field name="NUM">
                                64
                            </field>
                        </shadow>
                    </value>
                    <value name="DIVISOR">
                        <shadow type="math_number">
                            <field name="NUM">
                                10
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_constrain">
                    <value name="VALUE">
                        <shadow type="math_number">
                            <field name="NUM">
                                50
                            </field>
                        </shadow>
                    </value>
                    <value name="LOW">
                        <shadow type="math_number">
                            <field name="NUM">
                                1
                            </field>
                        </shadow>
                    </value>
                    <value name="HIGH">
                        <shadow type="math_number">
                            <field name="NUM">
                                100
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="math_random_int">
                    <value name="FROM">
                        <shadow type="math_number">
                            <field name="NUM">
                                1
                            </field>
                        </shadow>
                    </value>
                    <value name="TO">
                        <shadow type="math_number">
                            <field name="NUM">
                                100
                            </field>
                        </shadow>
                    </value>
                </block>
            </category>
            <category name="文本" colour="%{BKY_TEXTS_HUE}">
                <block type="text"></block>
                <block type="text_join"></block>
                <block type="text_append">
                    <value name="TEXT">
                        <shadow type="text"></shadow>
                    </value>
                </block>
                <block type="text_length">
                    <value name="VALUE">
                        <shadow type="text">
                            <field name="TEXT">abc</field>
                        </shadow>
                    </value>
                </block>
                <block type="text_isEmpty">
                    <value name="VALUE">
                        <shadow type="text">
                            <field name="TEXT"></field>
                        </shadow>
                    </value>
                </block>
                <block type="text_indexOf">
                    <value name="VALUE">
                        <block type="variables_get">
                            <field name="VAR">文本</field>
                        </block>
                    </value>
                    <value name="FIND">
                        <shadow type="text">
                            <field name="TEXT">abc</field>
                        </shadow>
                    </value>
                </block>
                <block type="text_charAt">
                    <value name="VALUE">
                        <block type="variables_get">
                            <field name="VAR">文本</field>
                        </block>
                    </value>
                </block>
                <block type="text_getSubstring">
                    <value name="STRING">
                        <block type="variables_get">
                            <field name="VAR">文本</field>
                        </block>
                    </value>
                </block>
                <block type="text_changeCase">
                    <value name="TEXT">
                        <shadow type="text">
                            <field name="TEXT">abc</field>
                        </shadow>
                    </value>
                </block>
                <block type="text_trim">
                    <value name="TEXT">
                        <shadow type="text">
                            <field name="TEXT">abc</field>
                        </shadow>
                    </value>
                </block>
                <block type="text_print">
                    <value name="TEXT">
                        <shadow type="text">
                            <field name="TEXT">abc</field>
                        </shadow>
                    </value>
                </block>
                <block type="text_prompt_ext">
                    <value name="TEXT">
                        <shadow type="text">
                            <field name="TEXT">abc</field>
                        </shadow>
                    </value>
                </block>
            </category>
            <category name="列表" colour="%{BKY_LISTS_HUE}">
                <block type="lists_create_with">
                    <mutation items="0"></mutation>
                </block>
                <block type="lists_create_with"></block>
                <block type="lists_repeat">
                    <value name="NUM">
                        <shadow type="math_number">
                            <field name="NUM">5</field>
                        </shadow>
                    </value>
                </block>
                <block type="lists_length"></block>
                <block type="lists_isEmpty"></block>
                <block type="lists_indexOf">
                    <value name="VALUE">
                        <block type="variables_get">
                            <field name="VAR">列表</field>
                        </block>
                    </value>
                </block>
                <block type="lists_getIndex">
                    <value name="VALUE">
                        <block type="variables_get">
                            <field name="VAR">列表</field>
                        </block>
                    </value>
                </block>
                <block type="lists_setIndex">
                    <value name="LIST">
                        <block type="variables_get">
                            <field name="VAR">列表</field>
                        </block>
                    </value>
                </block>
                <block type="lists_getSublist">
                    <value name="LIST">
                        <block type="variables_get">
                            <field name="VAR">列表</field>
                        </block>
                    </value>
                </block>
                <block type="lists_split">
                    <value name="DELIM">
                        <shadow type="text">
                            <field name="TEXT">,</field>
                        </shadow>
                    </value>
                </block>
                <block type="lists_sort"></block>
            </category>
            <category name="色彩" colour="%{BKY_COLOUR_HUE}">
                <block type="colour_picker">
                </block>
                <block type="colour_random">
                </block>
                <block type="colour_rgb">
                    <value name="RED">
                        <shadow type="math_number">
                            <field name="NUM">
                                100
                            </field>
                        </shadow>
                    </value>
                    <value name="GREEN">
                        <shadow type="math_number">
                            <field name="NUM">
                                50
                            </field>
                        </shadow>
                    </value>
                    <value name="BLUE">
                        <shadow type="math_number">
                            <field name="NUM">
                                0
                            </field>
                        </shadow>
                    </value>
                </block>
                <block type="colour_blend">
                    <value name="COLOUR1">
                        <shadow type="colour_picker">
                            <field name="COLOUR">
                                #ff0000
                            </field>
                        </shadow>
                    </value>
                    <value name="COLOUR2">
                        <shadow type="colour_picker">
                            <field name="COLOUR">
                                #3333ff
                            </field>
                        </shadow>
                    </value>
                    <value name="RATIO">
                        <shadow type="math_number">
                            <field name="NUM">
                                0.5
                            </field>
                        </shadow>
                    </value>
                </block>
            </category>
            <category name="输入" colour="%{BKY_TEXTS_HUE}">
                <block type="text"></block>
                <block type="text_prompt_ext">
                    <value name="TEXT">
                        <shadow type="text">
                            <field name="TEXT">输入</field>
                        </shadow>
                    </value>
                </block>
            </category>
            <category name="海龟" colour="%{BKY_TEXTS_HUE}">
                <block type="draw_move"></block>
                <block type="draw_turn"></block>
                <block type="draw_shape"></block>
                <block type="draw_pen"></block>
                <block type="draw_color"></block>
                <block type="draw_write"></block>
                <block type="draw_circle"></block>
                <block type="draw_stamp"></block>
                <block type="begin_fill"></block>
                <block type="end_fill"></block>
                <block type="goto"></block>
                <block type="draw_speed"></block>
                <block type="draw_pos"></block>
            </category>
            <sep></sep>
            <category name="easygui" colour="120">
                <label text="两个第三方块不能同时使用！"></label>
                <block type="eb-halloworld"></block>
                <block type="eb-halloworld-1"></block>
                <block type="savebox"></block>
                <block type="fileopenbox"></block>
                <block type="codebox"></block>
                <block type="passwordbox"></block>
                <block type="boolbox"></block>
                <label text="正在更新中"></label>
            </category>
            <category name="box3常用" colour="270">
                <label text="两个第三方块不能同时使用！"></label>
                <label text="‘玩家发言’及后面的块生成的代码须加上"></label>
                <label text="world.querySelectorAll('player')"></label>
                <block type="box31"></block>
                <block type="box32"></block>
                <block type="box33"></block>
                <block type="box34"></block>
                <block type="box35"></block>
                <block type="box36"></block>
                <block type="box37"></block>
                <block type="box38"></block>
                <label text="代码贡献：ZNS卿本尊"></label>
            </category>
            <category name="支持文档" colour="250">
                <label text="Eblock支持文档"></label>
                <label text="（这是老版本的文档）"></label>
                <label text="引言： Eblock是由白篮独立开发的积木式编程软件，具备了生成/运行/保存代码的功能，适用于编程初学者。Eblock基于google-blockly进行二次开发并开源。"></label>
                <label text="编写目的：通过对eblock的使用，初学编程的用户可以快速生成代码片段。"></label>
                <label text="软件的使用："></label>
                <label text="在线使用：通过访问http://e-block.gitee.io 或http://etuptools.gitee.io 来在线使用eblock"></label>
                <label text="下载：通过访问https://gitee.com/etuptools/etuptools/raw/master/eblock.zip 来下载eblock最新版本的归档"></label>
                <label text="在左侧积木栏中拉出要使用的积木，点击生成代码后软件将会自动生成js和python两种代码，点击运行代码后如果用户搭建的代码块可"></label>
                <label text="运行，软件将会在浏览器环境内运行js代码，点击保存代码后软件自动保存扩展名为.eblock的积木归档（正在开发此功能），点击文档"></label>
                <label text="按钮将会在新标签页中打开支持文档（即本文档），点击光源按钮后软件会切换为不同的色调。"></label>
                <label text="软件结构："></label>
                <label text="前端部分主体为index.html和blue.html，分别为不同色调的前端页面"></label>
                <label text="引用文件：block.js定义了默认代码块的样式，core.js定义了编辑器主题样式，turtle.js为第三方积木块扩展"></label>
                <label text="二次开发："></label>
                <label text="建议使用google-blockly提供的block factory生成新代码块。eblock使用了mdui框架。"></label>
                <label text="历史版本更新："></label>
                <label text="更新一、更新于2020.7.27"></label>
                <label text="php_compressed.js：php语言支持，lua_compressed.js：lua语言支持，dart_compressed.js：dart语言支持，blockly-demo.css：单一样式表，"></label>
                <label text="删除积木：可以将其拖动到界面右下角的，废纸篓图标声音：增加声音支持（原版blockly声音支持），增加了多语言的可选择性，目前"></label>
                <label text="支持js、python、php、lua、dart语言，双语言切换：中/英文切换"></label>
                <label text="更新二：更新于2020.9.22"></label>
                <label text="etupcode更名为eblock（易块），去除了双语言切换，去除了原版的特效声音支持，更新了支持文档（即本文档），增加了对其他浏览器"></label>
                <label text="的支持和优化，增加了支持文件：turtle.js（自定义的python汉化海龟库），网页框架由原来的bootstrap改为了由jsdelivrcdn支持的mdui，"></label>
                <label text="将原有js更名为core.js和block.js，增加了移动端大小比例适配"></label>
            </category>
            <sep></sep>
            <category name="变量" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE">
            </category>
            <category name="函数" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE">
            </category>
        </xml>
    </div>
    <!-- 以上是编辑器 -->
    <script>
        var inst = new mdui.Tooltip('#play', {
            content: '运行代码'
        });
        var demoWorkspace = Blockly.inject('blocklyDiv', {
            toolbox: document.getElementById('toolbox')
        });
        //定义toolbox
        Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'), demoWorkspace);
        var demoWorkspace = Blockly.inject('blocklyDiv', {
            toolbox: document.getElementById('toolbox')
        });
        //定义toolbox里面的block为既定var
        function showjs() {
            Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
            var code = Blockly.JavaScript.workspaceToCode(demoWorkspace);
            //让varcode等于上面定义的东西
            alert(code);
            mdui.snackbar({
                message: '代码已经生成，如果没有代码弹出框请反馈给编辑器作者'
            });
        }

        function showpy() {
            Blockly.Python.INFINITE_LOOP_TRAP = true;
            var code = Blockly.Python.workspaceToCode(demoWorkspace);
            //让varcode等于上面定义的东西
            alert(code);
            mdui.snackbar({
                message: '代码已经生成，如果没有代码弹出框请反馈给编辑器作者'
            });
        }

        function lan() {
            window.open("http://doutianyang.me");
        }

        function runCode() {
            window.LoopTrap = 1000;
            Blockly.JavaScript.INFINITE_LOOP_TRAP =
                'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
            var code = Blockly.JavaScript.workspaceToCode(demoWorkspace);
            //还是var
            Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
            try {
                eval(code);
                mdui.snackbar({
                    message: '代码已经运行，如果没有代码弹出框请反馈给编辑器作者'
                });
            } catch (e) {
                alert(e);
                mdui.snackbar({
                    message: '代码已经运行，如果没有代码弹出框请反馈给编辑器作者'
                });
            }
        }
    </script>
</body>

</html>